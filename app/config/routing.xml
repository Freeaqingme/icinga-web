<?xml version="1.0" encoding="UTF-8"?>
<configurations xmlns="http://agavi.org/agavi/1.0/config">
	<configuration>
		<routes>
		
			<!-- INDEX -->
			<route name="index_page" pattern="^/$" module="%actions.default_module%" action="%actions.default_action%" />
		
			<!-- ICINGAAppKit routes -->
			<route name="appkit" pattern="^/appkit" module="%actions.default_module%" action="%actions.default_action%">
				
				<!-- Get an image -->
				<route name="appkit.image" pattern="^/image/(image:[\w\d-_\/\.]+)$" action="Widgets.ShowImage" output_type="image" />
				
				<route name="appkit.login" pattern="^/login" action="Login"/>
				
				<!-- <route name="appkit.login" pattern="^/login" action="AjaxLogin">
					<route name="appkit.login.provider" pattern="^/json" action="AjaxLogin" output_type="json" />
				</route> -->
				
				<route name="appkit.logout" pattern="^/logout" action="Logout"/>
				
				
				<route name="appkit.about" pattern="^/about" action="%actions.default_action%"/>
				
				<route name="appkit.squishloader" pattern="^/squishloader/(type:([\w\.\-\_\s]+))" action="Widgets.SquishLoader" output_type="simplecontent" />
				
				<!-- AJAX handlers -->
				<route name=".ajax" pattern="^/ajax">
					<route name=".autocomplete" pattern="^/autocomplete/(type:[\w\._]+)" action="Ajax.AutoComplete" output_type="json" />
					<route name=".fs" pattern="^/fs/(type:[\w\._]+)" action="Ajax.FileSource" output_type="ajax" />
					<route name=".test" pattern="^/test" action="Ajax.Test" />
				</route>
				
				<route name="appkit.admin" pattern="^/admin" action="Admin.Index">
				
					<route name=".users" pattern="^/users" action="Admin.Users.Index">
						<route pattern="^/(id:(\d+|new))">
							<route name=".edit" pattern="^$" action="Admin.Users.Edit" />
						</route>
					</route>
					
					<route name="appkit.admin.groups" pattern="^/groups" action="Admin.Groups.Index">
						<route pattern="^/(id:(\d+|new))">
							<route name=".edit" pattern="^$" action="Admin.Groups.Edit" />
						</route>
					</route>
					
					<route name=".logs" pattern="^/logs" action="Admin.ViewLogs" />
					
				</route>
				
				
				<route pattern="^/ext" name=".ext">
					<route pattern="^/applicationState$" name=".applicationState" output_type="javascript" action="Ext.ApplicationState" />
					<route pattern="^/dynascript/(script:([\w-_\.]+))$" name=".dynamicScriptSource" output_type="javascript" action="Ext.DynamicJavascriptSource" />
				</route>
			</route>
			
			<!-- My routes (AppKit preferences) -->
			<route name="my" pattern="^/my" module="AppKit">
				<route pattern="^$" action="User.Index" />
				
				<route name=".preferences" pattern="^/preferences">
					<route pattern="^$" action="User.Preferences" /> 
				</route>
			</route>
			
			<!-- ICINGA routes -->
			<route name="icinga" pattern="^/web" module="Web">
				<route pattern="^$" action="Index" />
				
				<route name=".hostDetail" pattern="/host" action="Icinga.HostDetail">
					<route name=".single" pattern="^/(hostname:([\w\.\-\_\s]+))$" action="Icinga.HostDetailSingle" />
				</route>
				
				<route name=".serviceDetail" pattern="/service" action="Icinga.ServiceDetail">
					<route name=".single" pattern="^/(hostname:([\w\.\-\_\s]+))/(servicename:([\w\.\-\_\s]+))$" action="Icinga.ServiceDetailSingle" />
				</route>
				
				<route name=".portalView" pattern="^/portal$" action="Icinga.PortalView" />
				
				<route pattern="^/cronks" name=".cronks" output_type="simplecontent" module="Cronks">

					<route name=".crloader" pattern="^/cloader/(cronk:([\w\.\-\_\s]+))" action="System.CronkLoader" />

					<route name=".crlisting.json" pattern="^/clisting/json" output_type="json" action="System.CronkListing" />
					<route name=".objectsearch.json" pattern="^/objectSearch/json" output_type="json" action="System.ObjectSearch" />
					<route name=".statusSummary.json" pattern="^/statusSummary/json" output_type="json" action="System.StatusSummary" />

					<route name=".viewProc" pattern="^/viewproc/(template:([\w\.\-\_\s]+))">
						<route name=".json" pattern="^/json" output_type="json" action="System.ViewProc">
							<route name=".metaInfo" pattern="^/inf" action="System.ViewProc.MetaInformation" />
						</route>
					</route>
					
					<route name=".persistentprovider.json" pattern="^/persistenceProvider/json" output_type="json" action="Icinga.Cronks.PersistenceProvider" />
				</route>
				
				<route pattern="^/ext" name=".ext">
					<route pattern="/applicationState" name=".applicationState" output_type="javascript" action="Icinga.Ext.ApplicationState" />
				</route>

				<route name=".simpleDataProvider.json" pattern="^/simpleDataProvider/json" output_type="json" action="IcingaApiSimpleDataProvider" />

			</route>
			
		</routes>
	</configuration>
</configurations>
