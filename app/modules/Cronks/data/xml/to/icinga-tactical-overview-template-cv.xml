<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<template>
    
    <!-- 
    	Meta description of the templates, that anybody
    	knows what the template is doing
    -->
    <meta>
        <parameter name="name">Default template for Tactical Overview</parameter>
        <parameter name="description">Displays a Tactical Overview</parameter>
        <parameter name="author">icinga-web developers</parameter>
    </meta>

	<!--
		data sources 
	-->
	<datasources>
		<datasource id="cv_name">
			<source_type>IcingaApi</source_type>
			<target>IcingaApi::TARGET_CUSTOMVARIABLE</target>
			<columns>CUSTOMVARIABLE_NAME</columns>
		</datasource>

		<datasource id="cv_val">
			<source_type>IcingaApi</source_type>
			<target>IcingaApi::TARGET_CUSTOMVARIABLE</target>
			<columns>CUSTOMVARIABLE_VALUE</columns>
		</datasource>
	</datasources>
	
	

    <!--
    	html template
    -->
    <template_code>
		<cv_aggregate>
			<![CDATA[
				<?php
					$data = $t->ds2Array('cv_val', array(array(
						'CUSTOMVARIABLE_NAME', $CUSTOMVARIABLE_NAME
					)));

					foreach ($data as $row) {
						echo $t->renderSub('icinga-tactical-overview-groupstat', 'customvariable', array(
							'CUSTOMVARIABLE_NAME' => $CUSTOMVARIABLE_NAME,
							'CUSTOMVARIABLE_VALUE' => $row['CUSTOMVARIABLE_VALUE']
						));
					}
				?>
			]]>
		</cv_aggregate>

    	<MAIN>
	    	<![CDATA[
				<div style="padding: 5px 5px;">
				<?php echo $t->ds2Template('cv_name', 'cv_aggregate', '__xcount')?>
				</div>
			]]>
		</MAIN>
    </template_code>
</template>