<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<LINK REL="stylesheet" TYPE="text/css" TITLE="Style" href="../../stylesheet.css">
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="bannercell" rowspan="2"><a href="http://www.phing.info/"><img src="http://www.phing.info/images/phing.gif" alt="http://www.phing.info/" align="left" border="0"></a></td>
<td style="text-align:right"><h2>Source Code Coverage</h2></td>
</tr>
<tr><td style="text-align:right">Designed for use with <a href="http://www.phpunit.de">PHPUnit</a>, <a href="http://www.xdebug.org/">Xdebug</a> and <a href="http://www.phing.info/">Phing</a>.</td></tr>
</table>
<hr size="1">
<table class="log" cellpadding="5" cellspacing="0" width="100%"><tr class="a">
<td class="small">Methods: 14</td>
<td class="small">LOC: 267</td>
<td class="small">Statements: 0</td>
</tr></table>
<table class="log" cellpadding="5" cellspacing="0" width="100%"><tbody><tr>
<td class="legendItem" width="0%">Legend:</td>
<td class="legendValue" width="100%">
<span class="legendCovered">executed</span><span class="legendUncovered">not executed</span><span class="legendDeadCode">dead code</span>
</td>
</tr></tbody></table>
<table class="log" cellpadding="5" cellspacing="0" width="100%">
<tr>
<th width="100%">Source file</th>
<th>Statements</th>
<th>Methods</th>
<th width="250" colspan="2" nowrap>Total coverage</th>
</tr>
<tr class="a">
<td>Capsule.php</td>
<td>-</td>
<td>0.0%</td>
<td>0.0%</td>
<td><table cellspacing="0" cellpadding="0" border="0" width="100%" style="display: inline"><tr><td class="uncovered" width="200" height="12">Â </td></tr></table></td>
</tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%">
<tr>
<td class="lineCount">1</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">&lt;?php</pre></td>
</tr>
<tr>
<td class="lineCount">2</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">3</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">/**</pre></td>
</tr>
<tr>
<td class="lineCount">4</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * Capsule is a simple "template" engine that essentially provides an isolated context</pre></td>
</tr>
<tr>
<td class="lineCount">5</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * for PHP scripts.</pre></td>
</tr>
<tr>
<td class="lineCount">6</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> *</pre></td>
</tr>
<tr>
<td class="lineCount">7</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * There is no special templating language, and therefore no limitations to what</pre></td>
</tr>
<tr>
<td class="lineCount">8</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * can be accomplished within templates. The main purpose of Capsule is to separate</pre></td>
</tr>
<tr>
<td class="lineCount">9</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * the business logic from display / output logic.</pre></td>
</tr>
<tr>
<td class="lineCount">10</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> *</pre></td>
</tr>
<tr>
<td class="lineCount">11</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * @author Hans Lellelid &lt;hans@xmpl.org&gt;</pre></td>
</tr>
<tr>
<td class="lineCount">12</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * @version $Revision: 557 $</pre></td>
</tr>
<tr>
<td class="lineCount">13</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * @package phing.lib</pre></td>
</tr>
<tr>
<td class="lineCount">14</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> */</pre></td>
</tr>
<tr>
<td class="lineCount">15</td>
<td class="coverageCount"></td>
<td class="srcLineClassStart"><pre class="srcLine">class Capsule {</pre></td>
</tr>
<tr>
<td class="lineCount">16</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">17</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">18</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Look for templates here (if relative path provided).</pre></td>
</tr>
<tr>
<td class="lineCount">19</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @var string</pre></td>
</tr>
<tr>
<td class="lineCount">20</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">21</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    protected $templatePath;</pre></td>
</tr>
<tr>
<td class="lineCount">22</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">23</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">24</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Where should output files be written?</pre></td>
</tr>
<tr>
<td class="lineCount">25</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * (This is named inconsistently to be compatible w/ Texen.)</pre></td>
</tr>
<tr>
<td class="lineCount">26</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @var string</pre></td>
</tr>
<tr>
<td class="lineCount">27</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">28</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    protected $outputDirectory;</pre></td>
</tr>
<tr>
<td class="lineCount">29</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">30</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">31</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * The variables that can be used by the templates.</pre></td>
</tr>
<tr>
<td class="lineCount">32</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @var array Hash of variables.</pre></td>
</tr>
<tr>
<td class="lineCount">33</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">34</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    public $vars = array();</pre></td>
</tr>
<tr>
<td class="lineCount">35</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">36</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">37</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Has template been initialized.</pre></td>
</tr>
<tr>
<td class="lineCount">38</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">39</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    protected $initialized = false;</pre></td>
</tr>
<tr>
<td class="lineCount">40</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">41</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">42</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Stores the pre-parse() include_path.</pre></td>
</tr>
<tr>
<td class="lineCount">43</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @var string</pre></td>
</tr>
<tr>
<td class="lineCount">44</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">45</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    private $old_include_path;</pre></td>
</tr>
<tr>
<td class="lineCount">46</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">47</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function __construct() {</pre></td>
</tr>
<tr>
<td class="lineCount">48</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">49</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">50</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">51</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Clears one or several or all variables.</pre></td>
</tr>
<tr>
<td class="lineCount">52</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param mixed $which String name of var, or array of names.</pre></td>
</tr>
<tr>
<td class="lineCount">53</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @return void</pre></td>
</tr>
<tr>
<td class="lineCount">54</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">55</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function clear($which = null) {</pre></td>
</tr>
<tr>
<td class="lineCount">56</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        if ($which === null) {</pre></td>
</tr>
<tr>
<td class="lineCount">57</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            $this-&gt;vars = array();</pre></td>
</tr>
<tr>
<td class="lineCount">58</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        } elseif (is_array($which)) {</pre></td>
</tr>
<tr>
<td class="lineCount">59</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            foreach($which as $var) {</pre></td>
</tr>
<tr>
<td class="lineCount">60</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">                unset($this-&gt;vars[$var]);</pre></td>
</tr>
<tr>
<td class="lineCount">61</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            }</pre></td>
</tr>
<tr>
<td class="lineCount">62</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        } else {</pre></td>
</tr>
<tr>
<td class="lineCount">63</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            unset($this-&gt;vars[$which]);</pre></td>
</tr>
<tr>
<td class="lineCount">64</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        }</pre></td>
</tr>
<tr>
<td class="lineCount">65</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">66</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">67</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">68</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Set the basepath to use for template lookups.</pre></td>
</tr>
<tr>
<td class="lineCount">69</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param string $v</pre></td>
</tr>
<tr>
<td class="lineCount">70</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">71</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function setTemplatePath($v) {</pre></td>
</tr>
<tr>
<td class="lineCount">72</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        $this-&gt;templatePath = rtrim($v, DIRECTORY_SEPARATOR.'/');</pre></td>
</tr>
<tr>
<td class="lineCount">73</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">74</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">75</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">76</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Get the basepath to use for template lookups.</pre></td>
</tr>
<tr>
<td class="lineCount">77</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @return string</pre></td>
</tr>
<tr>
<td class="lineCount">78</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">79</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function getTemplatePath() {</pre></td>
</tr>
<tr>
<td class="lineCount">80</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        return $this-&gt;templatePath;</pre></td>
</tr>
<tr>
<td class="lineCount">81</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">82</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">83</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">84</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Set a basepath to use for output file creation.</pre></td>
</tr>
<tr>
<td class="lineCount">85</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param string $v</pre></td>
</tr>
<tr>
<td class="lineCount">86</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">87</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function setOutputDirectory($v) {</pre></td>
</tr>
<tr>
<td class="lineCount">88</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        $this-&gt;outputDirectory = rtrim($v, DIRECTORY_SEPARATOR.'/');</pre></td>
</tr>
<tr>
<td class="lineCount">89</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">90</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">91</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">92</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Get basepath to use for output file creation.</pre></td>
</tr>
<tr>
<td class="lineCount">93</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @return string</pre></td>
</tr>
<tr>
<td class="lineCount">94</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">95</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function getOutputDirectory() {</pre></td>
</tr>
<tr>
<td class="lineCount">96</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        return $this-&gt;outputDirectory;</pre></td>
</tr>
<tr>
<td class="lineCount">97</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">98</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">99</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">100</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Low overhead (no output buffering) method to simply dump template</pre></td>
</tr>
<tr>
<td class="lineCount">101</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * to buffer.</pre></td>
</tr>
<tr>
<td class="lineCount">102</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     *</pre></td>
</tr>
<tr>
<td class="lineCount">103</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param string $__template</pre></td>
</tr>
<tr>
<td class="lineCount">104</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @return void</pre></td>
</tr>
<tr>
<td class="lineCount">105</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @throws Exception - if template cannot be found</pre></td>
</tr>
<tr>
<td class="lineCount">106</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">107</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function display($__template) {</pre></td>
</tr>
<tr>
<td class="lineCount">108</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">109</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        // Prepend "private" variable names with $__ in this function</pre></td>
</tr>
<tr>
<td class="lineCount">110</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        // to keep namespace conflict potential to a minimum.</pre></td>
</tr>
<tr>
<td class="lineCount">111</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">112</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        // Alias this class to $generator.</pre></td>
</tr>
<tr>
<td class="lineCount">113</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        $generator = $this;</pre></td>
</tr>
<tr>
<td class="lineCount">114</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">115</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        if (isset($this-&gt;vars['this'])) {</pre></td>
</tr>
<tr>
<td class="lineCount">116</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            throw new Exception("Assigning a variable named \$this to a context conflicts with class namespace.");</pre></td>
</tr>
<tr>
<td class="lineCount">117</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        }</pre></td>
</tr>
<tr>
<td class="lineCount">118</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">119</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        // extract variables into local namespace</pre></td>
</tr>
<tr>
<td class="lineCount">120</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        extract($this-&gt;vars);</pre></td>
</tr>
<tr>
<td class="lineCount">121</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">122</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        // prepend template path to include path,</pre></td>
</tr>
<tr>
<td class="lineCount">123</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        // so that include "path/relative/to/templates"; can be used within templates</pre></td>
</tr>
<tr>
<td class="lineCount">124</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        $__old_inc_path = ini_get('include_path');</pre></td>
</tr>
<tr>
<td class="lineCount">125</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        ini_set('include_path', $this-&gt;templatePath . PATH_SEPARATOR . $__old_inc_path);</pre></td>
</tr>
<tr>
<td class="lineCount">126</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">127</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        @ini_set('track_errors', true);</pre></td>
</tr>
<tr>
<td class="lineCount">128</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        include $__template;</pre></td>
</tr>
<tr>
<td class="lineCount">129</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        @ini_restore('track_errors');</pre></td>
</tr>
<tr>
<td class="lineCount">130</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">131</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        // restore the include path</pre></td>
</tr>
<tr>
<td class="lineCount">132</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        ini_set('include_path', $__old_inc_path);</pre></td>
</tr>
<tr>
<td class="lineCount">133</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">134</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        if (!empty($php_errormsg)) {</pre></td>
</tr>
<tr>
<td class="lineCount">135</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            throw new Exception("Unable to parse template " . $__template . ": " . $php_errormsg);</pre></td>
</tr>
<tr>
<td class="lineCount">136</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        }</pre></td>
</tr>
<tr>
<td class="lineCount">137</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">138</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">139</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">140</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Fetches the results of a tempalte parse and either returns</pre></td>
</tr>
<tr>
<td class="lineCount">141</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * the string or writes results to a specified output file.</pre></td>
</tr>
<tr>
<td class="lineCount">142</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     *</pre></td>
</tr>
<tr>
<td class="lineCount">143</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param string $template The template filename (relative to templatePath or absolute).</pre></td>
</tr>
<tr>
<td class="lineCount">144</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param string $outputFile If specified, contents of template will also be written to this file.</pre></td>
</tr>
<tr>
<td class="lineCount">145</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param boolean $append Should output be appended to source file?</pre></td>
</tr>
<tr>
<td class="lineCount">146</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @return string The "parsed" template output.</pre></td>
</tr>
<tr>
<td class="lineCount">147</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @throws Exception - if template not found.</pre></td>
</tr>
<tr>
<td class="lineCount">148</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">149</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function parse($template, $outputFile = null, $append = false) {</pre></td>
</tr>
<tr>
<td class="lineCount">150</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">151</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        // main work done right here:</pre></td>
</tr>
<tr>
<td class="lineCount">152</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        // hopefully this works recursively ... fingers crossed.</pre></td>
</tr>
<tr>
<td class="lineCount">153</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        ob_start();</pre></td>
</tr>
<tr>
<td class="lineCount">154</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">155</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        try {</pre></td>
</tr>
<tr>
<td class="lineCount">156</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            $this-&gt;display($template);</pre></td>
</tr>
<tr>
<td class="lineCount">157</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        } catch (Exception $e) {</pre></td>
</tr>
<tr>
<td class="lineCount">158</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            ob_end_flush(); // flush the output on error (so we can see up to what point it parsed everything)</pre></td>
</tr>
<tr>
<td class="lineCount">159</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            throw $e;</pre></td>
</tr>
<tr>
<td class="lineCount">160</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        }</pre></td>
</tr>
<tr>
<td class="lineCount">161</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">162</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        $output = ob_get_contents();</pre></td>
</tr>
<tr>
<td class="lineCount">163</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        ob_end_clean();</pre></td>
</tr>
<tr>
<td class="lineCount">164</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">165</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        if ($outputFile !== null) {</pre></td>
</tr>
<tr>
<td class="lineCount">166</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            $outputFile = $this-&gt;resolvePath($outputFile, $this-&gt;outputDirectory);</pre></td>
</tr>
<tr>
<td class="lineCount">167</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">168</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            $flags = null;</pre></td>
</tr>
<tr>
<td class="lineCount">169</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            if ($append) $flags = FILE_APPEND;</pre></td>
</tr>
<tr>
<td class="lineCount">170</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">171</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            if (!file_put_contents($outputFile, $output, $flags) &amp;&amp; $output != "") {</pre></td>
</tr>
<tr>
<td class="lineCount">172</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">                throw new Exception("Unable to write output to " . $outputFile);</pre></td>
</tr>
<tr>
<td class="lineCount">173</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            }</pre></td>
</tr>
<tr>
<td class="lineCount">174</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        }</pre></td>
</tr>
<tr>
<td class="lineCount">175</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">176</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        return $output;</pre></td>
</tr>
<tr>
<td class="lineCount">177</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">178</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">179</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">180</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * This returns a "best guess" path for the given file.</pre></td>
</tr>
<tr>
<td class="lineCount">181</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     *</pre></td>
</tr>
<tr>
<td class="lineCount">182</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param string $file File name or possibly absolute path.</pre></td>
</tr>
<tr>
<td class="lineCount">183</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param string $basepath The basepath that should be prepended if $file is not absolute.</pre></td>
</tr>
<tr>
<td class="lineCount">184</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @return string "Best guess" path for this file.</pre></td>
</tr>
<tr>
<td class="lineCount">185</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">186</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    protected function resolvePath($file, $basepath) {</pre></td>
</tr>
<tr>
<td class="lineCount">187</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        if ( !($file{0} == DIRECTORY_SEPARATOR || $file{0} == '/')</pre></td>
</tr>
<tr>
<td class="lineCount">188</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            // also account for C:\ style path</pre></td>
</tr>
<tr>
<td class="lineCount">189</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">                &amp;&amp; !($file{1} == ':' &amp;&amp; ($file{2} ==  DIRECTORY_SEPARATOR || $file{2} == '/'))) {</pre></td>
</tr>
<tr>
<td class="lineCount">190</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            if ($basepath != null) {</pre></td>
</tr>
<tr>
<td class="lineCount">191</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">                $file = $basepath . DIRECTORY_SEPARATOR . $file;</pre></td>
</tr>
<tr>
<td class="lineCount">192</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            }</pre></td>
</tr>
<tr>
<td class="lineCount">193</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        }</pre></td>
</tr>
<tr>
<td class="lineCount">194</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        return $file;</pre></td>
</tr>
<tr>
<td class="lineCount">195</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">196</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">197</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">198</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Gets value of specified var or NULL if var has not been put().</pre></td>
</tr>
<tr>
<td class="lineCount">199</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param string $name Variable name to retrieve.</pre></td>
</tr>
<tr>
<td class="lineCount">200</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @return mixed</pre></td>
</tr>
<tr>
<td class="lineCount">201</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">202</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function get($name) {</pre></td>
</tr>
<tr>
<td class="lineCount">203</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        if (!isset($this-&gt;vars[$name])) return null;</pre></td>
</tr>
<tr>
<td class="lineCount">204</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        return $this-&gt;vars[$name];</pre></td>
</tr>
<tr>
<td class="lineCount">205</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">206</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">207</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">208</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Merges in passed hash to vars array.</pre></td>
</tr>
<tr>
<td class="lineCount">209</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     *</pre></td>
</tr>
<tr>
<td class="lineCount">210</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Given an array like:</pre></td>
</tr>
<tr>
<td class="lineCount">211</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     *</pre></td>
</tr>
<tr>
<td class="lineCount">212</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     *            array(     'myvar' =&gt; 'Hello',</pre></td>
</tr>
<tr>
<td class="lineCount">213</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     *                    'myvar2' =&gt; 'Hello')</pre></td>
</tr>
<tr>
<td class="lineCount">214</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     *</pre></td>
</tr>
<tr>
<td class="lineCount">215</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Resulting template will have access to $myvar and $myvar2.</pre></td>
</tr>
<tr>
<td class="lineCount">216</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     *</pre></td>
</tr>
<tr>
<td class="lineCount">217</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param array $vars</pre></td>
</tr>
<tr>
<td class="lineCount">218</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param boolean $recursiveMerge Should matching keys be recursively merged?</pre></td>
</tr>
<tr>
<td class="lineCount">219</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @return void</pre></td>
</tr>
<tr>
<td class="lineCount">220</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">221</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function putAll($vars, $recursiveMerge = false) {</pre></td>
</tr>
<tr>
<td class="lineCount">222</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        if ($recursiveMerge) {</pre></td>
</tr>
<tr>
<td class="lineCount">223</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            $this-&gt;vars = array_merge_recursive($this-&gt;vars, $vars);</pre></td>
</tr>
<tr>
<td class="lineCount">224</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        } else {</pre></td>
</tr>
<tr>
<td class="lineCount">225</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            $this-&gt;vars = array_merge($this-&gt;vars, $vars);</pre></td>
</tr>
<tr>
<td class="lineCount">226</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        }</pre></td>
</tr>
<tr>
<td class="lineCount">227</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">228</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">229</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">230</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Adds a variable to the context.</pre></td>
</tr>
<tr>
<td class="lineCount">231</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     *</pre></td>
</tr>
<tr>
<td class="lineCount">232</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Resulting template will have access to ${$name$} variable.</pre></td>
</tr>
<tr>
<td class="lineCount">233</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     *</pre></td>
</tr>
<tr>
<td class="lineCount">234</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param string $name</pre></td>
</tr>
<tr>
<td class="lineCount">235</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param mixed $value</pre></td>
</tr>
<tr>
<td class="lineCount">236</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">237</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function put($name, $value) {</pre></td>
</tr>
<tr>
<td class="lineCount">238</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        $this-&gt;vars[$name] = $value;</pre></td>
</tr>
<tr>
<td class="lineCount">239</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">240</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">241</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">242</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Put a variable into the context, assigning it by reference.</pre></td>
</tr>
<tr>
<td class="lineCount">243</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * This means that if the template modifies the variable, then it</pre></td>
</tr>
<tr>
<td class="lineCount">244</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * will also be modified in the context.</pre></td>
</tr>
<tr>
<td class="lineCount">245</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     *</pre></td>
</tr>
<tr>
<td class="lineCount">246</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param $name</pre></td>
</tr>
<tr>
<td class="lineCount">247</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param &amp;$value</pre></td>
</tr>
<tr>
<td class="lineCount">248</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">249</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function putRef($name, &amp;$value) {</pre></td>
</tr>
<tr>
<td class="lineCount">250</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        $this-&gt;vars[$name] = &amp;$value;</pre></td>
</tr>
<tr>
<td class="lineCount">251</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">252</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">253</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    /**</pre></td>
</tr>
<tr>
<td class="lineCount">254</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * Makes a copy of the value and puts it into the context.</pre></td>
</tr>
<tr>
<td class="lineCount">255</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * This is primarily to force copying (cloning) of objects, rather</pre></td>
</tr>
<tr>
<td class="lineCount">256</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * than the default behavior which is to assign them by reference.</pre></td>
</tr>
<tr>
<td class="lineCount">257</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param string $name</pre></td>
</tr>
<tr>
<td class="lineCount">258</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     * @param mixed $value</pre></td>
</tr>
<tr>
<td class="lineCount">259</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">     */</pre></td>
</tr>
<tr>
<td class="lineCount">260</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    function putCopy($name, $value) {</pre></td>
</tr>
<tr>
<td class="lineCount">261</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        if (is_object($value)) {</pre></td>
</tr>
<tr>
<td class="lineCount">262</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">            $value = clone $value;</pre></td>
</tr>
<tr>
<td class="lineCount">263</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        }</pre></td>
</tr>
<tr>
<td class="lineCount">264</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">        $this-&gt;vars[$name] = $value;</pre></td>
</tr>
<tr>
<td class="lineCount">265</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">    }</pre></td>
</tr>
<tr>
<td class="lineCount">266</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">267</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">}</pre></td>
</tr>
</table>
<br><table width="100%">
<tr><td><hr noshade size="1"></td></tr>
<tr><td class="small">Report generated at 2011-07-09T21:37:02+02:00</td></tr>
</table>
</body>
</html>
